# v2v-mtv-ubuntu22-export.yaml
#
# vSphere → virt-v2v export (data-plane) driven by vSphere command path.
# NOTE: This is an EXPORT (virt-v2v), not download-only.

command: vsphere

# ------------------------------------------------------------------
# vCenter creds (pyvmomi control-plane)
# ------------------------------------------------------------------
vcenter: 192.168.73.42
vc_user: administrator@vsphere.local
vc_password_env: VC_PASSWORD
vc_insecure: true
vc_port: 443

# Inventory alignment (your vCenter DC name)
dc_name: data

# ------------------------------------------------------------------
# Legacy aliases (some code paths still look for vs_* keys)
# Keep these in sync with vc_* above.
# ------------------------------------------------------------------
vs_host: 10.73.213.134
vs_user: administrator@vsphere.local
vs_password_env: VC_PASSWORD

# virt-v2v vpx:// TLS policy
vs_no_verify: true

# ------------------------------------------------------------------
# REQUIRED: what the vsphere CLI should do
# ------------------------------------------------------------------
vs_action: export_vm

# ------------------------------------------------------------------
# Export target
# ------------------------------------------------------------------
vs_vm: mtv-ubuntu22-server
vs_datacenter: data

# Transport: vddk | ssh
vs_transport: vddk

# VDDK (required for vddk transport)
vs_vddk_libdir: /opt/vmware-vix-disklib-distrib
# vs_vddk_thumbprint: "AA:BB:CC:..."   # only needed if vs_no_verify:false (or if your code requires it)

# Optional advanced VDDK transports override
# vs_vddk_transports: "nbdssl:nbd"

# Optional snapshot controls (off by default)
vs_create_snapshot: false
# vs_snapshot_moref: snapshot-123

# Concurrency (keep 1 for safety)
vs_v2v_concurrency: 1

# Extra virt-v2v flags
vs_v2v_extra_args:
  - "-v"
  - "-x"

# ------------------------------------------------------------------
# Output
# ------------------------------------------------------------------
output_dir: ./out/v2v/mtv-ubuntu22-server
out_format: qcow2
compress: true

# ------------------------------------------------------------------
# IMPORTANT: This is the vSphere->virt-v2v export path
# (don’t also set download-only)
# ------------------------------------------------------------------
vs_v2v: true
vs_download_only: false

# Do NOT run internal pipeline or post-v2v stages
use_v2v: false
post_v2v: false

# Optional smoke testing AFTER export (disabled)
libvirt_test: false
qemu_test: false
uefi: true
memory: 2048
vcpus: 1
timeout: 90
headless: true

# Logging / reporting
verbose: 1
report: v2v-export-report.md
