# ------------------------------------------------------------------------------
# Photon OS 5.0 (Azure image) → KVM/QEMU validation
# ------------------------------------------------------------------------------

command: local

# ------------------------------------------------------------------------------
# Input
# ------------------------------------------------------------------------------
# Either:
#  - photon-azure-5.0-dde71ec57.x86_64.vhd
#  - photon-azure-5.0-dde71ec57.x86_64.vhd.tar.gz
#
vmdk: ./photon-azure-5.0-dde71ec57.x86_64.vhd

# ------------------------------------------------------------------------------
# Output
# ------------------------------------------------------------------------------
output_dir: ./out
flatten: true
flatten_format: qcow2

to_output: photon-azure-5.0.qcow2
out_format: qcow2
compress: true
compress_level: 6

# ------------------------------------------------------------------------------
# Fix policy (Photon-safe)
# ------------------------------------------------------------------------------
fstab_mode: stabilize-all
print_fstab: true

regen_initramfs: true
no_grub: false
remove_vmware_tools: false   # Azure image, not VMware

# ------------------------------------------------------------------------------
# Validation & Safety
# ------------------------------------------------------------------------------
dry_run: false
checksum: true
enable_recovery: true
report: photon-azure-report.md

# ------------------------------------------------------------------------------
# QEMU smoke test (HEADLESS)
# ------------------------------------------------------------------------------
qemu_test: true
headless: true

# Azure Photon images are UEFI-friendly → force UEFI
uefi: true

memory: 2048
vcpus: 2
timeout: 90

# ------------------------------------------------------------------------------
# Logging
# ------------------------------------------------------------------------------
verbose: 1
log_file: photon-azure-qemu.log

